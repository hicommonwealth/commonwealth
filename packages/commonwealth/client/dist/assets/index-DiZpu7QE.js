var C=(e=>(e.MissingApiKey="MISSING_API_KEY",e.ModalNotReady="MODAL_NOT_READY",e.MalformedResponse="MALFORMED_RESPONSE",e.InvalidArgument="INVALID_ARGUMENT",e.ExtensionNotInitialized="EXTENSION_NOT_INITIALIZED",e.IncompatibleExtensions="INCOMPATIBLE_EXTENSIONS",e))(C||{}),Y=(e=>(e.SyncWeb3Method="SYNC_WEB3_METHOD",e.DuplicateIframe="DUPLICATE_IFRAME",e.ReactNativeEndpointConfiguration="REACT_NATIVE_ENDPOINT_CONFIGURATION",e.DeprecationNotice="DEPRECATION_NOTICE",e))(Y||{}),pe=(e=>(e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError",e[e.MagicLinkFailedVerification=-1e4]="MagicLinkFailedVerification",e[e.MagicLinkExpired=-10001]="MagicLinkExpired",e[e.MagicLinkRateLimited=-10002]="MagicLinkRateLimited",e[e.MagicLinkInvalidRedirectURL=-10006]="MagicLinkInvalidRedirectURL",e[e.UserAlreadyLoggedIn=-10003]="UserAlreadyLoggedIn",e[e.UpdateEmailFailed=-10004]="UpdateEmailFailed",e[e.UserRequestEditEmail=-10005]="UserRequestEditEmail",e[e.InactiveRecipient=-10010]="InactiveRecipient",e[e.AccessDeniedToUser=-10011]="AccessDeniedToUser",e[e.RedirectLoginComplete=-10015]="RedirectLoginComplete",e))(pe||{}),O=(e=>(e.MetaMask="metamask",e.CoinbaseWallet="coinbase_wallet",e))(O||{}),re=(e=>(e.WalletSelected="wallet_selected",e.WalletConnected="wallet_connected",e.WalletRejected="wallet_rejected",e))(re||{}),d=(e=>(e.LoginWithSms="magic_auth_login_with_sms",e.LoginWithEmailOTP="magic_auth_login_with_email_otp",e.LoginWithMagicLink="magic_auth_login_with_magic_link",e.LoginWithCredential="magic_auth_login_with_credential",e.SetAuthorizationToken="magic_auth_set_authorization_token",e.GetIdToken="magic_auth_get_id_token",e.GenerateIdToken="magic_auth_generate_id_token",e.GetMetadata="magic_auth_get_metadata",e.IsLoggedIn="magic_is_logged_in",e.Logout="magic_auth_logout",e.UpdateEmail="magic_auth_update_email",e.UserSettings="magic_auth_settings",e.UserSettingsTestMode="magic_auth_settings_testing_mode",e.LoginWithSmsTestMode="magic_auth_login_with_sms_testing_mode",e.LoginWithEmailOTPTestMode="magic_auth_login_with_email_otp_testing_mode",e.LoginWithMagicLinkTestMode="magic_login_with_magic_link_testing_mode",e.LoginWithCredentialTestMode="magic_auth_login_with_credential_testing_mode",e.GetIdTokenTestMode="magic_auth_get_id_token_testing_mode",e.GenerateIdTokenTestMode="magic_auth_generate_id_token_testing_mode",e.GetMetadataTestMode="magic_auth_get_metadata_testing_mode",e.IsLoggedInTestMode="magic_auth_is_logged_in_testing_mode",e.LogoutTestMode="magic_auth_logout_testing_mode",e.UpdateEmailTestMode="magic_auth_update_email_testing_mode",e.IntermediaryEvent="magic_intermediary_event",e.RequestAccounts="eth_requestAccounts",e.GetInfo="magic_get_info",e.ShowUI="magic_wallet",e.NFTPurchase="magic_nft_purchase",e.NFTCheckout="magic_nft_checkout",e.RequestUserInfoWithUI="mc_request_user_info",e.Disconnect="mc_disconnect",e.UpdatePhoneNumber="magic_auth_update_phone_number",e.UpdatePhoneNumberTestMode="magic_auth_update_phone_number_testing_mode",e.RecoverAccount="magic_auth_recover_account",e.RecoverAccountTestMode="magic_auth_recover_account_testing_mode",e.MagicBoxHeartBeat="magic_box_heart_beat",e.AutoConnect="mc_auto_connect",e.Login="mc_login",e.EncryptV1="magic_auth_encrypt_v1",e.DecryptV1="magic_auth_decrypt_v1",e.ShowNFTs="magic_show_nfts",e.ShowOnRamp="magic_show_fiat_onramp",e.ShowSendTokensUI="magic_show_send_tokens_ui",e.ShowAddress="magic_show_address",e.ShowBalances="magic_show_balances",e))(d||{}),x=(e=>(e.MAGIC_HANDLE_RESPONSE="MAGIC_HANDLE_RESPONSE",e.MAGIC_OVERLAY_READY="MAGIC_OVERLAY_READY",e.MAGIC_SHOW_OVERLAY="MAGIC_SHOW_OVERLAY",e.MAGIC_HIDE_OVERLAY="MAGIC_HIDE_OVERLAY",e.MAGIC_HANDLE_EVENT="MAGIC_HANDLE_EVENT",e.MAGIC_MG_BOX_SEND_RECEIPT="MAGIC_MG_BOX_SEND_RECEIPT",e))(x||{}),se=(e=>(e.MAGIC_HANDLE_REQUEST="MAGIC_HANDLE_REQUEST",e))(se||{}),et=(e=>(e.MFA="mfa",e.Recovery="recovery",e))(et||{}),tt=(e=>(e.Harmony="HARMONY",e))(tt||{}),rt=(e=>(e.PhoneNumber="phone_number",e))(rt||{}),he={},it=Object.create,le=Object.defineProperty,st=Object.defineProperties,nt=Object.getOwnPropertyDescriptor,ot=Object.getOwnPropertyDescriptors,at=Object.getOwnPropertyNames,Ie=Object.getOwnPropertySymbols,lt=Object.getPrototypeOf,ke=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable,ve=(e,t,r)=>t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,me=(e,t)=>{for(var r in t||(t={}))ke.call(t,r)&&ve(e,r,t[r]);if(Ie)for(var r of Ie(t))ut.call(t,r)&&ve(e,r,t[r]);return e},Ue=(e,t)=>st(e,ot(t)),ht=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ct=(e,t)=>{for(var r in t)le(e,r,{get:t[r],enumerable:!0})},dt=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of at(t))!ke.call(e,s)&&s!==r&&le(e,s,{get:()=>t[s],enumerable:!(i=nt(t,s))||i.enumerable});return e},pt=(e,t,r)=>(r=e!=null?it(lt(e)):{},dt(!e||!e.__esModule?le(r,"default",{value:e,enumerable:!0}):r,e)),A=(e,t,r)=>new Promise((i,s)=>{var n=h=>{try{o(r.next(h))}catch(l){s(l)}},u=h=>{try{o(r.throw(h))}catch(l){s(l)}},o=h=>h.done?i(h.value):Promise.resolve(h.value).then(n,u);o((r=r.apply(e,t)).next())}),mt=ht((e,t)=>{var r=Object.prototype.hasOwnProperty,i="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(i=!1));function n(l,a,c){this.fn=l,this.context=a,this.once=c||!1}function u(l,a,c,g,v){if(typeof c!="function")throw new TypeError("The listener must be a function");var I=new n(c,g||l,v),R=i?i+a:a;return l._events[R]?l._events[R].fn?l._events[R]=[l._events[R],I]:l._events[R].push(I):(l._events[R]=I,l._eventsCount++),l}function o(l,a){--l._eventsCount===0?l._events=new s:delete l._events[a]}function h(){this._events=new s,this._eventsCount=0}h.prototype.eventNames=function(){var l=[],a,c;if(this._eventsCount===0)return l;for(c in a=this._events)r.call(a,c)&&l.push(i?c.slice(1):c);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(a)):l},h.prototype.listeners=function(l){var a=i?i+l:l,c=this._events[a];if(!c)return[];if(c.fn)return[c.fn];for(var g=0,v=c.length,I=new Array(v);g<v;g++)I[g]=c[g].fn;return I},h.prototype.listenerCount=function(l){var a=i?i+l:l,c=this._events[a];return c?c.fn?1:c.length:0},h.prototype.emit=function(l,a,c,g,v,I){var R=i?i+l:l;if(!this._events[R])return!1;var p=this._events[R],L=arguments.length,P,_;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),L){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,a),!0;case 3:return p.fn.call(p.context,a,c),!0;case 4:return p.fn.call(p.context,a,c,g),!0;case 5:return p.fn.call(p.context,a,c,g,v),!0;case 6:return p.fn.call(p.context,a,c,g,v,I),!0}for(_=1,P=new Array(L-1);_<L;_++)P[_-1]=arguments[_];p.fn.apply(p.context,P)}else{var Ze=p.length,F;for(_=0;_<Ze;_++)switch(p[_].once&&this.removeListener(l,p[_].fn,void 0,!0),L){case 1:p[_].fn.call(p[_].context);break;case 2:p[_].fn.call(p[_].context,a);break;case 3:p[_].fn.call(p[_].context,a,c);break;case 4:p[_].fn.call(p[_].context,a,c,g);break;default:if(!P)for(F=1,P=new Array(L-1);F<L;F++)P[F-1]=arguments[F];p[_].fn.apply(p[_].context,P)}}return!0},h.prototype.on=function(l,a,c){return u(this,l,a,c,!1)},h.prototype.once=function(l,a,c){return u(this,l,a,c,!0)},h.prototype.removeListener=function(l,a,c,g){var v=i?i+l:l;if(!this._events[v])return this;if(!a)return o(this,v),this;var I=this._events[v];if(I.fn)I.fn===a&&(!g||I.once)&&(!c||I.context===c)&&o(this,v);else{for(var R=0,p=[],L=I.length;R<L;R++)(I[R].fn!==a||g&&!I[R].once||c&&I[R].context!==c)&&p.push(I[R]);p.length?this._events[v]=p.length===1?p[0]:p:o(this,v)}return this},h.prototype.removeAllListeners=function(l){var a;return l?(a=i?i+l:l,this._events[a]&&o(this,a)):(this._events=new s,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=i,h.EventEmitter=h,typeof t<"u"&&(t.exports=h)});function Et(e){let t={exports:{}};return e(t,t.exports),t.exports}var ft=Number.MAX_SAFE_INTEGER||9007199254740991,Ee={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:ft,MAX_SAFE_COMPONENT_LENGTH:16},gt=typeof process=="object"&&he&&he.NODE_DEBUG&&/\bsemver\b/i.test(he.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{},E=gt,z=Et(function(e,t){let{MAX_SAFE_COMPONENT_LENGTH:r}=Ee,i=(t=e.exports={}).re=[],s=t.src=[],n=t.t={},u=0,o=(h,l,a)=>{let c=u++;E(c,l),n[h]=c,s[c]=l,i[c]=new RegExp(l,a?"g":void 0)};o("NUMERICIDENTIFIER","0|[1-9]\\d*"),o("NUMERICIDENTIFIERLOOSE","[0-9]+"),o("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),o("MAINVERSION",`(${s[n.NUMERICIDENTIFIER]})\\.(${s[n.NUMERICIDENTIFIER]})\\.(${s[n.NUMERICIDENTIFIER]})`),o("MAINVERSIONLOOSE",`(${s[n.NUMERICIDENTIFIERLOOSE]})\\.(${s[n.NUMERICIDENTIFIERLOOSE]})\\.(${s[n.NUMERICIDENTIFIERLOOSE]})`),o("PRERELEASEIDENTIFIER",`(?:${s[n.NUMERICIDENTIFIER]}|${s[n.NONNUMERICIDENTIFIER]})`),o("PRERELEASEIDENTIFIERLOOSE",`(?:${s[n.NUMERICIDENTIFIERLOOSE]}|${s[n.NONNUMERICIDENTIFIER]})`),o("PRERELEASE",`(?:-(${s[n.PRERELEASEIDENTIFIER]}(?:\\.${s[n.PRERELEASEIDENTIFIER]})*))`),o("PRERELEASELOOSE",`(?:-?(${s[n.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[n.PRERELEASEIDENTIFIERLOOSE]})*))`),o("BUILDIDENTIFIER","[0-9A-Za-z-]+"),o("BUILD",`(?:\\+(${s[n.BUILDIDENTIFIER]}(?:\\.${s[n.BUILDIDENTIFIER]})*))`),o("FULLPLAIN",`v?${s[n.MAINVERSION]}${s[n.PRERELEASE]}?${s[n.BUILD]}?`),o("FULL",`^${s[n.FULLPLAIN]}$`),o("LOOSEPLAIN",`[v=\\s]*${s[n.MAINVERSIONLOOSE]}${s[n.PRERELEASELOOSE]}?${s[n.BUILD]}?`),o("LOOSE",`^${s[n.LOOSEPLAIN]}$`),o("GTLT","((?:<|>)?=?)"),o("XRANGEIDENTIFIERLOOSE",`${s[n.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),o("XRANGEIDENTIFIER",`${s[n.NUMERICIDENTIFIER]}|x|X|\\*`),o("XRANGEPLAIN",`[v=\\s]*(${s[n.XRANGEIDENTIFIER]})(?:\\.(${s[n.XRANGEIDENTIFIER]})(?:\\.(${s[n.XRANGEIDENTIFIER]})(?:${s[n.PRERELEASE]})?${s[n.BUILD]}?)?)?`),o("XRANGEPLAINLOOSE",`[v=\\s]*(${s[n.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[n.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[n.XRANGEIDENTIFIERLOOSE]})(?:${s[n.PRERELEASELOOSE]})?${s[n.BUILD]}?)?)?`),o("XRANGE",`^${s[n.GTLT]}\\s*${s[n.XRANGEPLAIN]}$`),o("XRANGELOOSE",`^${s[n.GTLT]}\\s*${s[n.XRANGEPLAINLOOSE]}$`),o("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),o("COERCERTL",s[n.COERCE],!0),o("LONETILDE","(?:~>?)"),o("TILDETRIM",`(\\s*)${s[n.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",o("TILDE",`^${s[n.LONETILDE]}${s[n.XRANGEPLAIN]}$`),o("TILDELOOSE",`^${s[n.LONETILDE]}${s[n.XRANGEPLAINLOOSE]}$`),o("LONECARET","(?:\\^)"),o("CARETTRIM",`(\\s*)${s[n.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",o("CARET",`^${s[n.LONECARET]}${s[n.XRANGEPLAIN]}$`),o("CARETLOOSE",`^${s[n.LONECARET]}${s[n.XRANGEPLAINLOOSE]}$`),o("COMPARATORLOOSE",`^${s[n.GTLT]}\\s*(${s[n.LOOSEPLAIN]})$|^$`),o("COMPARATOR",`^${s[n.GTLT]}\\s*(${s[n.FULLPLAIN]})$|^$`),o("COMPARATORTRIM",`(\\s*)${s[n.GTLT]}\\s*(${s[n.LOOSEPLAIN]}|${s[n.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",o("HYPHENRANGE",`^\\s*(${s[n.XRANGEPLAIN]})\\s+-\\s+(${s[n.XRANGEPLAIN]})\\s*$`),o("HYPHENRANGELOOSE",`^\\s*(${s[n.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[n.XRANGEPLAINLOOSE]})\\s*$`),o("STAR","(<|>)?=?\\s*\\*"),o("GTE0","^\\s*>=\\s*0.0.0\\s*$"),o("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}),ye=/^[0-9]+$/,De=(e,t)=>{let r=ye.test(e),i=ye.test(t);return r&&i&&(e=+e,t=+t),e===t?0:r&&!i?-1:i&&!r?1:e<t?-1:1},_t=(e,t)=>De(t,e),It={compareIdentifiers:De,rcompareIdentifiers:_t},{MAX_LENGTH:we,MAX_SAFE_INTEGER:J}=Ee,{re:Re,t:Me}=z,{compareIdentifiers:q}=It,y=class{constructor(e,t){if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),e instanceof y){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>we)throw new TypeError(`version is longer than ${we} characters`);E("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?Re[Me.LOOSE]:Re[Me.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>J||this.major<0)throw new TypeError("Invalid major version");if(this.minor>J||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>J||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<J)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(E("SemVer.compare",this.version,this.options,e),!(e instanceof y)){if(typeof e=="string"&&e===this.version)return 0;e=new y(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof y||(e=new y(e,this.options)),q(this.major,e.major)||q(this.minor,e.minor)||q(this.patch,e.patch)}comparePre(e){if(e instanceof y||(e=new y(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(E("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r!==i)return q(r,i)}while(++t)}compareBuild(e){e instanceof y||(e=new y(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(E("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r!==i)return q(r,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}},vt=(e,t,r)=>new y(e,r).compare(new y(t,r)),j=vt,yt=(e,t,r)=>j(e,t,r)===0,wt=yt,Rt=(e,t,r)=>j(e,t,r)!==0,Mt=Rt,$t=(e,t,r)=>j(e,t,r)>0,At=$t,Nt=(e,t,r)=>j(e,t,r)>=0,Tt=Nt,Ot=(e,t,r)=>j(e,t,r)<0,Lt=Ot,St=(e,t,r)=>j(e,t,r)<=0,bt=St,Pt=(e,t,r,i)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return wt(e,r,i);case"!=":return Mt(e,r,i);case">":return At(e,r,i);case">=":return Tt(e,r,i);case"<":return Lt(e,r,i);case"<=":return bt(e,r,i);default:throw new TypeError(`Invalid operator: ${t}`)}},ce=Pt,V=Symbol("SemVer ANY"),B=class{static get ANY(){return V}constructor(e,t){if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),e instanceof B){if(e.loose===!!t.loose)return e;e=e.value}E("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===V?this.value="":this.value=this.operator+this.semver.version,E("comp",this)}parse(e){let t=this.options.loose?$e[Ae.COMPARATORLOOSE]:$e[Ae.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new y(r[2],this.options.loose):this.semver=V}toString(){return this.value}test(e){if(E("Comparator.test",e,this.options.loose),this.semver===V||e===V)return!0;if(typeof e=="string")try{e=new y(e,this.options)}catch{return!1}return ce(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof B))throw new TypeError("a Comparator is required");if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),this.operator==="")return this.value===""||new G(e.value,t).test(this.value);if(e.operator==="")return e.value===""||new G(this.value,t).test(e.semver);let r=!(this.operator!==">="&&this.operator!==">"||e.operator!==">="&&e.operator!==">"),i=!(this.operator!=="<="&&this.operator!=="<"||e.operator!=="<="&&e.operator!=="<"),s=this.semver.version===e.semver.version,n=!(this.operator!==">="&&this.operator!=="<="||e.operator!==">="&&e.operator!=="<="),u=ce(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),o=ce(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return r||i||s&&n||u||o}},{re:$e,t:Ae}=z,G=class{constructor(e,t){if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),e instanceof G)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new G(e.raw,t);if(e instanceof B)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let{loose:t}=this.options;e=e.trim();let r=t?M[w.HYPHENRANGELOOSE]:M[w.HYPHENRANGE];e=e.replace(r,Xt(this.options.includePrerelease)),E("hyphen replace",e),e=e.replace(M[w.COMPARATORTRIM],Ct),E("comparator trim",e,M[w.COMPARATORTRIM]),e=(e=(e=e.replace(M[w.TILDETRIM],kt)).replace(M[w.CARETTRIM],Ut)).split(/\s+/).join(" ");let i=t?M[w.COMPARATORLOOSE]:M[w.COMPARATOR];return e.split(" ").map(s=>Dt(s,this.options)).join(" ").split(/\s+/).map(s=>Ht(s,this.options)).filter(this.options.loose?s=>!!s.match(i):()=>!0).map(s=>new B(s,this.options))}intersects(e,t){if(!(e instanceof G))throw new TypeError("a Range is required");return this.set.some(r=>Ne(r,t)&&e.set.some(i=>Ne(i,t)&&r.every(s=>i.every(n=>s.intersects(n,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new y(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(Bt(this.set[t],e,this.options))return!0;return!1}},{re:M,t:w,comparatorTrimReplace:Ct,tildeTrimReplace:kt,caretTrimReplace:Ut}=z,Ne=(e,t)=>{let r=!0,i=e.slice(),s=i.pop();for(;r&&i.length;)r=i.every(n=>s.intersects(n,t)),s=i.pop();return r},Dt=(e,t)=>(E("comp",e,t),e=Wt(e,t),E("caret",e),e=xt(e,t),E("tildes",e),e=Ft(e,t),E("xrange",e),e=Vt(e,t),E("stars",e),e),$=e=>!e||e.toLowerCase()==="x"||e==="*",xt=(e,t)=>e.trim().split(/\s+/).map(r=>Gt(r,t)).join(" "),Gt=(e,t)=>{let r=t.loose?M[w.TILDELOOSE]:M[w.TILDE];return e.replace(r,(i,s,n,u,o)=>{let h;return E("tilde",e,i,s,n,u,o),$(s)?h="":$(n)?h=`>=${s}.0.0 <${+s+1}.0.0-0`:$(u)?h=`>=${s}.${n}.0 <${s}.${+n+1}.0-0`:o?(E("replaceTilde pr",o),h=`>=${s}.${n}.${u}-${o} <${s}.${+n+1}.0-0`):h=`>=${s}.${n}.${u} <${s}.${+n+1}.0-0`,E("tilde return",h),h})},Wt=(e,t)=>e.trim().split(/\s+/).map(r=>jt(r,t)).join(" "),jt=(e,t)=>{E("caret",e,t);let r=t.loose?M[w.CARETLOOSE]:M[w.CARET],i=t.includePrerelease?"-0":"";return e.replace(r,(s,n,u,o,h)=>{let l;return E("caret",e,s,n,u,o,h),$(n)?l="":$(u)?l=`>=${n}.0.0${i} <${+n+1}.0.0-0`:$(o)?l=n==="0"?`>=${n}.${u}.0${i} <${n}.${+u+1}.0-0`:`>=${n}.${u}.0${i} <${+n+1}.0.0-0`:h?(E("replaceCaret pr",h),l=n==="0"?u==="0"?`>=${n}.${u}.${o}-${h} <${n}.${u}.${+o+1}-0`:`>=${n}.${u}.${o}-${h} <${n}.${+u+1}.0-0`:`>=${n}.${u}.${o}-${h} <${+n+1}.0.0-0`):(E("no pr"),l=n==="0"?u==="0"?`>=${n}.${u}.${o}${i} <${n}.${u}.${+o+1}-0`:`>=${n}.${u}.${o}${i} <${n}.${+u+1}.0-0`:`>=${n}.${u}.${o} <${+n+1}.0.0-0`),E("caret return",l),l})},Ft=(e,t)=>(E("replaceXRanges",e,t),e.split(/\s+/).map(r=>qt(r,t)).join(" ")),qt=(e,t)=>{e=e.trim();let r=t.loose?M[w.XRANGELOOSE]:M[w.XRANGE];return e.replace(r,(i,s,n,u,o,h)=>{E("xRange",e,i,s,n,u,o,h);let l=$(n),a=l||$(u),c=a||$(o),g=c;return s==="="&&g&&(s=""),h=t.includePrerelease?"-0":"",l?i=s===">"||s==="<"?"<0.0.0-0":"*":s&&g?(a&&(u=0),o=0,s===">"?(s=">=",a?(n=+n+1,u=0,o=0):(u=+u+1,o=0)):s==="<="&&(s="<",a?n=+n+1:u=+u+1),s==="<"&&(h="-0"),i=`${s+n}.${u}.${o}${h}`):a?i=`>=${n}.0.0${h} <${+n+1}.0.0-0`:c&&(i=`>=${n}.${u}.0${h} <${n}.${+u+1}.0-0`),E("xRange return",i),i})},Vt=(e,t)=>(E("replaceStars",e,t),e.trim().replace(M[w.STAR],"")),Ht=(e,t)=>(E("replaceGTE0",e,t),e.trim().replace(M[t.includePrerelease?w.GTE0PRE:w.GTE0],"")),Xt=e=>(t,r,i,s,n,u,o,h,l,a,c,g,v)=>`${r=$(i)?"":$(s)?`>=${i}.0.0${e?"-0":""}`:$(n)?`>=${i}.${s}.0${e?"-0":""}`:u?`>=${r}`:`>=${r}${e?"-0":""}`} ${h=$(l)?"":$(a)?`<${+l+1}.0.0-0`:$(c)?`<${l}.${+a+1}.0-0`:g?`<=${l}.${a}.${c}-${g}`:e?`<${l}.${a}.${+c+1}-0`:`<=${h}`}`.trim(),Bt=(e,t,r)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let i=0;i<e.length;i++)if(E(e[i].semver),e[i].semver!==B.ANY&&e[i].semver.prerelease.length>0){let s=e[i].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0},Kt=(e,t,r)=>{try{t=new G(t,r)}catch{return!1}return t.test(e)},{MAX_LENGTH:Yt}=Ee,{re:Te,t:Oe}=z,zt=(e,t)=>{if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),e instanceof y)return e;if(typeof e!="string"||e.length>Yt||!(t.loose?Te[Oe.LOOSE]:Te[Oe.FULL]).test(e))return null;try{return new y(e,t)}catch{return null}},Jt=zt,{re:Q,t:Z}=z,Qt=(e,t)=>{if(e instanceof y)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;let r=null;if((t=t||{}).rtl){let i;for(;(i=Q[Z.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&i.index+i[0].length===r.index+r[0].length||(r=i),Q[Z.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;Q[Z.COERCERTL].lastIndex=-1}else r=e.match(Q[Z.COERCE]);return r===null?null:Jt(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)};function Zt(e){return String.fromCharCode(parseInt(e.slice(1),16))}function er(e){return`%${`00${e.charCodeAt(0).toString(16)}`.slice(-2)}`}function tr(e){return btoa(encodeURIComponent(e).replace(/%[0-9A-F]{2}/g,Zt))}function rr(e){return decodeURIComponent(Array.from(atob(e),er).join(""))}function xe(e){return tr(JSON.stringify(e))}function ir(e){return JSON.parse(rr(e))}function H(e){return typeof e>"u"}function sr(e){return e===null}function Ge(e){return sr(e)||H(e)}function nr(e){return Ge(e)?!1:!H(e.jsonrpc)&&!H(e.id)&&(!H(e.result)||!H(e.error))}function or(e){return Ge(e)?!1:typeof e=="number"&&Object.values(pe).includes(e)}function de(e){if(!e)return!0;for(let t in e)if(Object.hasOwnProperty.call(e,t))return!1;return!0}var f={};function Yr(e,t){return Object.assign(f,t),e}var ar={"magic-sdk":"magic-sdk","@magic-sdk/react-native":"magic-sdk-rn","@magic-sdk/react-native-bare":"magic-sdk-rn-bare","@magic-sdk/react-native-expo":"magic-sdk-rn-expo"},k=class extends Error{constructor(e,t){super(`Magic SDK Error: [${e}] ${t}`),this.code=e,this.rawMessage=t,this.__proto__=Error,Object.setPrototypeOf(this,k.prototype)}},ne=class extends Error{constructor(e){super(),this.__proto__=Error;let t=Number(e==null?void 0:e.code);this.rawMessage=(e==null?void 0:e.message)||"Internal error",this.code=or(t)?t:pe.InternalError,this.message=`Magic RPC Error: [${this.code}] ${this.rawMessage}`,this.data=(e==null?void 0:e.data)||void 0,Object.setPrototypeOf(this,ne.prototype)}},ue=class{constructor(e,t){this.code=e,this.rawMessage=t,this.message=`Magic SDK Warning: [${e}] ${t}`}log(){console.warn(this.message)}},We=class extends Error{constructor(e,t,r,i){super(`Magic Extension Error (${e.name}): [${t}] ${r}`),this.code=t,this.rawMessage=r,this.data=i,this.__proto__=Error,Object.setPrototypeOf(this,We.prototype)}},Le=class{constructor(e,t,r){this.code=t,this.rawMessage=r,this.message=`Magic Extension Warning (${e.name}): [${t}] ${r}`}log(){console.warn(this.message)}};function lr(){return new k(C.MissingApiKey,"Please provide an API key that you acquired from the Magic developer dashboard.")}function zr(){return new k(C.ModalNotReady,"Modal is not ready.")}function ur(){return new k(C.MalformedResponse,"Response from the Magic iframe is malformed.")}function hr(e){return new k(C.ExtensionNotInitialized,`Extensions must be initialized with a Magic SDK instance before \`Extension.${e}\` can be accessed. Do not invoke \`Extension.${e}\` inside an extension constructor.`)}function cr(e){let t=`Some extensions are incompatible with \`${f.sdkName}@${f.version}\`:`;return e.filter(r=>typeof r.compat<"u"&&r.compat!==null).forEach(r=>{let i=r.compat[f.sdkName];typeof i=="string"?t+=`
  - Extension \`${r.name}\` supports version(s) \`${i}\``:i||(t+=`
  - Extension \`${r.name}\` does not support ${f.platform} environments.`)}),new k(C.IncompatibleExtensions,t)}function dr(e){let t=r=>{let i=r+1,s=i%10,n=i%100;return s===1&&n!==11?`${i}st`:s===2&&n!==12?`${i}nd`:s===3&&n!==13?`${i}rd`:`${i}th`};return new k(C.InvalidArgument,`Invalid ${t(e.argument)} argument given to \`${e.procedure}\`.
  Expected: \`${e.expected}\`
  Received: \`${e.received}\``)}function Jr(){return new ue(Y.DuplicateIframe,"Duplicate iframes found.")}function pr(){return new ue(Y.SyncWeb3Method,"Non-async web3 methods are deprecated in web3 > 1.0 and are not supported by the Magic web3 provider. Please use an async method instead.")}function mr(){return new ue(Y.ReactNativeEndpointConfiguration,`CUSTOM DOMAINS ARE NOT SUPPORTED WHEN USING MAGIC SDK WITH REACT NATIVE! The \`endpoint\` parameter SHOULD NOT be provided. The Magic \`<iframe>\` is automatically wrapped by a WebView pointed at \`${f.defaultEndpoint}\`. Changing this default behavior will lead to unexpected results and potentially security-threatening bugs.`)}function N(e){let{method:t,removalVersions:r,useInstead:i}=e,s=r[f.sdkName],n=i?` Use \`${i}\` instead.`:"",u=`\`${t}\` will be removed from \`${f.sdkName}\` in version \`${s}\`.${n}`;return new ue(Y.DeprecationNotice,u)}function*Er(){let e=0;for(;;)e<Number.MAX_SAFE_INTEGER?yield++e:e=0}var fr=Er();function je(){return fr.next().value}var Fe=Symbol("Payload pre-processed by Magic SDK");function qe(e){return Object.defineProperty(e,Fe,{value:!0,enumerable:!1}),e}function gr(e){return!!e[Fe]}function oe(e){var t,r,i;return gr(e)||(e.jsonrpc=(t=e.jsonrpc)!=null?t:"2.0",e.id=je(),e.method=(r=e.method)!=null?r:"noop",e.params=(i=e.params)!=null?i:[],qe(e)),e}function m(e,t=[]){return qe({params:t,method:e,jsonrpc:"2.0",id:je()})}var fe=class{constructor(e){e instanceof fe?(this._jsonrpc=e.payload.jsonrpc,this._id=e.payload.id,this._result=e.payload.result,this._error=e.payload.error):nr(e)?(this._jsonrpc=e.jsonrpc,this._id=e.id,this._result=e.result,this._error=e.error):(this._jsonrpc=e.jsonrpc,this._id=e.id,this._result=void 0,this._error=void 0)}applyError(e){return this._error=e,this}applyResult(e){return this._result=e,this}get hasError(){return typeof this._error<"u"&&this._error!==null}get hasResult(){return typeof this._result<"u"}get payload(){return{jsonrpc:this._jsonrpc,id:this._id,result:this._result,error:this._error}}},_r=pt(mt()),Ir=class extends _r.default{};function Ve(){let e=new Ir;return{emitter:e,createChainingEmitterMethod:(t,r)=>(...i)=>(e[t].apply(e,i),r),createBoundEmitterMethod:t=>(...r)=>e[t].apply(e,r)}}var He=Symbol("isPromiEvent");function vr(e){return!!e[He]}function Xe(e){let t=Be(e),{createBoundEmitterMethod:r,createChainingEmitterMethod:i}=Ve(),s=Symbol("Promise.then"),n=Symbol("Promise.catch"),u=Symbol("Promise.finally"),o=(a,c)=>(...g)=>{let v=c[a].apply(c,g);return h(v)},h=a=>Object.assign(a,{[He]:!0,[s]:a[s]||a.then,[n]:a[n]||a.catch,[u]:a[u]||a.finally,then:o(s,a),catch:o(n,a),finally:o(u,a),on:i("on",a),once:i("once",a),addListener:i("addListener",a),off:i("off",a),removeListener:i("removeListener",a),removeAllListeners:i("removeAllListeners",a),emit:r("emit"),eventNames:r("eventNames"),listeners:r("listeners"),listenerCount:r("listenerCount")}),l=h(t.then(a=>(l.emit("done",a),l.emit("settled"),a),a=>{throw l.emit("error",a),l.emit("settled"),a}));return l}function Be(e){return new Promise((t,r)=>{let i=e(t,r);Promise.resolve(i).catch(r)})}var U=class{constructor(e){this.sdk=e}get overlay(){return this.sdk.overlay}request(e){let t=this.overlay.post(se.MAGIC_HANDLE_REQUEST,oe(e)),r=Xe((s,n)=>{t.then(u=>{if(i(),u.hasError)n(new ne(u.payload.error));else if(u.hasResult)s(u.payload.result);else throw ur()}).catch(u=>{i(),n(u)})}),i=this.overlay.on(x.MAGIC_HANDLE_EVENT,s=>{var n;let{response:u}=s.data;if(u.id===e.id&&((n=u.result)!=null&&n.event)){let{event:o,params:h=[]}=u.result;r.emit(o,...h)}});return r}createIntermediaryEvent(e,t){return r=>{let i=m(d.IntermediaryEvent,[{payloadId:t,eventType:e,args:r}]);this.request(i)}}},T={"magic-sdk":"v18.0.0","@magic-sdk/react-native":"v14.0.0","@magic-sdk/react-native-bare":"v19.0.0","@magic-sdk/react-native-expo":"v19.0.0"},yr=class extends U{loginWithMagicLink(e){let t=f.sdkName==="@magic-sdk/react-native"||f.sdkName==="@magic-sdk/react-native-bare"||f.sdkName==="@magic-sdk/react-native-expo";N({method:"auth.loginWithMagicLink()",removalVersions:T,useInstead:t?"@magic-ext/auth auth.loginWithEmailOTP()":"@magic-ext/auth auth.loginWithMagicLink()"}).log();let{email:r,showUI:i=!0,redirectURI:s}=e,n=m(this.sdk.testMode?d.LoginWithMagicLinkTestMode:d.LoginWithMagicLink,[{email:r,showUI:i,redirectURI:s}]);return this.request(n)}loginWithSMS(e){N({method:"auth.loginWithSMS()",removalVersions:T,useInstead:"@magic-ext/auth auth.loginWithSMS()"}).log();let{phoneNumber:t}=e,r=m(this.sdk.testMode?d.LoginWithSmsTestMode:d.LoginWithSms,[{phoneNumber:t,showUI:!0}]);return this.request(r)}loginWithEmailOTP(e){N({method:"auth.loginWithEmailOTP()",removalVersions:T,useInstead:"@magic-ext/auth auth.loginWithEmailOTP()"}).log();let{email:t,showUI:r}=e,i=m(this.sdk.testMode?d.LoginWithEmailOTPTestMode:d.LoginWithEmailOTP,[{email:t,showUI:r}]);if(!r){let s=this.request(i);return s&&(s.on("verify-email-otp",n=>{this.createIntermediaryEvent("verify-email-otp",i.id)(n)}),s.on("cancel",()=>{this.createIntermediaryEvent("cancel",i.id)()})),s}return this.request(i)}loginWithCredential(e){N({method:"auth.loginWithCredential()",removalVersions:T,useInstead:"@magic-ext/auth auth.loginWithCredential()"}).log();let t=e??"";if(!e&&f.platform==="web"){t=window.location.search;let i=window.location.origin+window.location.pathname;window.history.replaceState(null,"",i)}let r=m(this.sdk.testMode?d.LoginWithCredentialTestMode:d.LoginWithCredential,[t]);return this.request(r)}setAuthorizationToken(e){N({method:"auth.setAuthorizationToken()",removalVersions:T,useInstead:"@magic-ext/auth auth.setAuthorizationToken()"}).log();let t=m(d.SetAuthorizationToken,[{jwt:e}]);return this.request(t)}updateEmailWithUI(e){N({method:"auth.updateEmailWithUI()",removalVersions:T,useInstead:"@magic-ext/auth auth.updateEmailWithUI()"}).log();let{email:t,showUI:r=!0}=e,i=m(this.sdk.testMode?d.UpdateEmailTestMode:d.UpdateEmail,[{email:t,showUI:r}]);return this.request(i)}updatePhoneNumberWithUI(){N({method:"auth.updatePhoneNumberWithUI()",removalVersions:T,useInstead:"@magic-ext/auth auth.updatePhoneNumberWithUI()"}).log();let e=m(this.sdk.testMode?d.UpdatePhoneNumberTestMode:d.UpdatePhoneNumber);return this.request(e)}},Ke={};ct(Ke,{clear:()=>wr,getItem:()=>S,iterate:()=>Ar,key:()=>Mr,keys:()=>$r,length:()=>Rr,removeItem:()=>K,setItem:()=>W});var ee;function b(e){return(...t)=>A(this,null,function*(){return ee||(ee=yield f.configureStorage()),yield ee.ready(),ee[e](...t)})}var S=b("getItem"),W=b("setItem"),K=b("removeItem"),wr=b("clear"),Rr=b("length"),Mr=b("key"),$r=b("keys"),Ar=b("iterate");function Nr(){let e=window.crypto.getRandomValues(new Uint8Array(16));e[6]=e[6]&15|64,e[8]=e[8]&191|128;let t="";return t+=e[0].toString(16),t+=e[1].toString(16),t+=e[2].toString(16),t+=e[3].toString(16),t+="-",t+=e[4].toString(16),t+=e[5].toString(16),t+="-",t+=e[6].toString(16),t+=e[7].toString(16),t+="-",t+=e[8].toString(16),t+=e[9].toString(16),t+="-",t+=e[10].toString(16),t+=e[11].toString(16),t+=e[12].toString(16),t+=e[13].toString(16),t+=e[14].toString(16),t+=e[15].toString(16),t}var ge="STORE_KEY_PRIVATE_KEY",ae="STORE_KEY_PUBLIC_JWK",_e="ECDSA",Ye="P-256",Tr={name:_e,namedCurve:Ye},Or={name:_e,namedCurve:Ye};function ze(){K(ae),K(ge)}function Lr(){return A(this,null,function*(){let e=yield Sr();if(!e){console.info("unable to create public key or webcrypto is unsupported");return}let{subtle:t}=window.crypto,r=yield S(ge);if(!r||!t){console.info("unable to find private key or webcrypto unsupported");return}let i={iat:Math.floor(new Date().getTime()/1e3),jti:Nr()},s={typ:"dpop+jwt",alg:"ES256",jwk:e},n={protected:Se(JSON.stringify(s)),claims:Se(JSON.stringify(i))},u=Cr(`${n.protected}.${n.claims}`),o={name:_e,hash:{name:"SHA-256"}},h=Ur(new Uint8Array(yield t.sign(o,r,u)));return`${n.protected}.${n.claims}.${h}`})}function Sr(){return A(this,null,function*(){if(!Pr()){console.info("webcrypto is not supported");return}return(yield S(ae))||(yield br()),S(ae)})}function br(){return A(this,null,function*(){let e=null,{subtle:t}=window.crypto,r=yield t.generateKey(Tr,!0,["sign"]),i=yield t.exportKey("jwk",r.privateKey);e=yield t.exportKey("jwk",r.publicKey);let s=yield t.importKey("jwk",i,Or,!1,["sign"]);yield W(ge,s),yield W(ae,e)})}function Pr(){let e=typeof window<"u"&&!!window.crypto,t=e&&!!window.crypto.subtle;return e&&t}function Se(e){return Je(kr(e))}function Cr(e){return new TextEncoder().encode(e)}function Je(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+/g,"")}function kr(e){return encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(t,r)=>String.fromCharCode(parseInt(r,16)))}function Ur(e){let t="";return e.forEach(r=>{t+=String.fromCharCode(r)}),Je(t)}var Dr=class extends U{constructor(){super(...arguments),this.localForageKey="mc_active_wallet"}getIdToken(e){let t=m(this.sdk.testMode?d.GetIdTokenTestMode:d.GetIdToken,[e]);return this.request(t)}generateIdToken(e){let t=m(this.sdk.testMode?d.GenerateIdTokenTestMode:d.GenerateIdToken,[e]);return this.request(t)}getInfo(){return A(this,null,function*(){let e=yield S(this.localForageKey),t=m(d.GetInfo,[{walletType:e}]);return this.request(t)})}isLoggedIn(){let e=m(this.sdk.testMode?d.IsLoggedInTestMode:d.IsLoggedIn);return this.request(e)}logout(){ze(),K(this.localForageKey);let e=m(this.sdk.testMode?d.LogoutTestMode:d.Logout);return this.request(e)}requestInfoWithUI(e){let t=m(d.RequestUserInfoWithUI,e?[e]:[]);return this.request(t)}showSettings(e){let t=m(this.sdk.testMode?d.UserSettingsTestMode:d.UserSettings,[e]);return this.request(t)}recoverAccount(e){let t=m(this.sdk.testMode?d.RecoverAccountTestMode:d.RecoverAccount,[e]);return this.request(t)}getMetadata(){N({method:"user.getMetadata()",removalVersions:T,useInstead:"user.getInfo()"}).log();let e=m(this.sdk.testMode?d.GetMetadataTestMode:d.GetMetadata);return this.request(e)}updateEmail(e){N({method:"user.updateEmail()",removalVersions:T,useInstead:"auth.updateEmailWithUI()"}).log();let{email:t,showUI:r=!0}=e,i=m(this.sdk.testMode?d.UpdateEmailTestMode:d.UpdateEmail,[{email:t,showUI:r}]);return this.request(i)}updatePhoneNumber(){N({method:"user.updatePhoneNumber()",removalVersions:T,useInstead:"auth.updatePhoneNumberWithUI()"}).log();let e=m(this.sdk.testMode?d.UpdatePhoneNumberTestMode:d.UpdatePhoneNumber);return this.request(e)}},xr=class extends U{constructor(){super(...arguments),this.localForageKey="mc_active_wallet"}connectWithUI(){return A(this,null,function*(){if(this.isMetaMaskBrowser())try{if(yield this.isWalletEnabled(O.MetaMask))return this.autoConnectIfWalletBrowser(O.MetaMask)}catch(i){console.error(i)}if(this.isCoinbaseWalletBrowser())try{if(yield this.isWalletEnabled(O.CoinbaseWallet))return this.autoConnectIfWalletBrowser(O.CoinbaseWallet)}catch(i){console.error(i)}let e=this.getUserEnv(),t=m(d.Login,[e]),r=this.request(t);return r.on(re.WalletSelected,i=>this.handleWalletSelected(Ue(me({},i),{payloadId:t.id}))),r})}showUI(){let e=m(d.ShowUI);return this.request(e)}getInfo(){return A(this,null,function*(){N({method:"wallet.getInfo()",removalVersions:T,useInstead:"user.getInfo()"}).log();let e=yield S(this.localForageKey),t=m(d.GetInfo,[{walletType:e}]);return this.request(t)})}disconnect(){N({method:"wallet.disconnect()",removalVersions:T,useInstead:"user.logout()"}).log(),ze(),K(this.localForageKey);let e=m(d.Disconnect);return this.request(e)}requestUserInfoWithUI(e){N({method:"wallet.requestUserInfoWithUI()",removalVersions:T,useInstead:"user.requestUserInfoWithUI()"}).log();let t=m(d.RequestUserInfoWithUI,e?[e]:[]);return this.request(t)}getProvider(){return A(this,null,function*(){switch(yield S(this.localForageKey)){case O.MetaMask:return this.getMetaMaskProvider();case O.CoinbaseWallet:return this.getCoinbaseProvider();default:return this.sdk.rpcProvider}})}isMetaMaskInstalled(){var e,t,r;return((e=window.ethereum)==null?void 0:e.isMetaMask)||!!((r=(t=window.ethereum)==null?void 0:t.providers)!=null&&r.find(i=>i==null?void 0:i.isMetaMask))}isMetaMaskBrowser(){return this.isMobile()&&this.isMetaMaskInstalled()}getMetaMaskProvider(){var e,t;return((t=(e=window.ethereum)==null?void 0:e.providers)==null?void 0:t.find(r=>r==null?void 0:r.isMetaMask))||window.ethereum}connectToMetaMask(){if(this.isMobile()&&!this.isMetaMaskInstalled()){let e=`https://metamask.app.link/dapp/${window.location.href.replace(/(^\w+:|^)\/\//,"")}`;window.location.href=e}return this.getMetaMaskProvider().request({method:"eth_requestAccounts"})}isCoinbaseWalletInstalled(){var e,t,r;return((e=window.ethereum)==null?void 0:e.isCoinbaseWallet)||!!((r=(t=window.ethereum)==null?void 0:t.providers)!=null&&r.find(i=>i==null?void 0:i.isCoinbaseWallet))}isCoinbaseWalletBrowser(){var e;return!!((e=window.ethereum)!=null&&e.isCoinbaseBrowser)}getCoinbaseProvider(){var e,t;return((t=(e=window.ethereum)==null?void 0:e.providers)==null?void 0:t.find(r=>r==null?void 0:r.isCoinbaseWallet))||window.ethereum}connectToCoinbaseWallet(){if(this.isMobile()&&!this.isCoinbaseWalletBrowser()){let e=`https://go.cb-w.com/dapp?cb_url=${encodeURIComponent(window.location.href)}`;window.location.href=e}return this.getCoinbaseProvider().request({method:"eth_requestAccounts"})}isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Silk|Opera Mini/i.test(navigator.userAgent)}getUserEnv(){return{env:{isMetaMaskInstalled:this.isMetaMaskInstalled(),isCoinbaseWalletInstalled:this.isCoinbaseWalletInstalled()}}}connectToThirdPartyWallet(e){switch(e){case O.MetaMask:return this.connectToMetaMask();case O.CoinbaseWallet:return this.connectToCoinbaseWallet();default:throw new Error(`Invalid provider: ${e}. Must be one of "metamask" or "coinbase_wallet".`)}}isWalletEnabled(e){let t=m("mc_is_wallet_enabled",[{wallet:e}]);return this.request(t)}handleWalletSelected(e){return A(this,null,function*(){try{let t=yield this.connectToThirdPartyWallet(e.wallet);yield W(this.localForageKey,e.wallet),this.createIntermediaryEvent(re.WalletConnected,e.payloadId)(t)}catch(t){console.error(t),this.createIntermediaryEvent(re.WalletRejected,e.payloadId)()}})}autoConnectIfWalletBrowser(e){return A(this,null,function*(){let t;e===O.MetaMask&&(t=yield this.getMetaMaskProvider().request({method:"eth_requestAccounts"})),e===O.CoinbaseWallet&&(t=yield this.getCoinbaseProvider().request({method:"eth_requestAccounts"})),yield W(this.localForageKey,e);let r=m(d.AutoConnect,[{wallet:e,address:t}]);return this.request(r)})}},{createBoundEmitterMethod:te,createChainingEmitterMethod:D}=Ve(),Gr=class extends U{constructor(){super(...arguments),this.isMagic=!0,this.on=D("on",this),this.once=D("once",this),this.addListener=D("addListener",this),this.off=D("off",this),this.removeListener=D("removeListener",this),this.removeAllListeners=D("removeAllListeners",this),this.emit=te("emit"),this.eventNames=te("eventNames"),this.listeners=te("listeners"),this.listenerCount=te("listenerCount")}sendAsync(e,t){if(!t)throw dr({procedure:"Magic.rpcProvider.sendAsync",argument:1,expected:"function",received:t===null?"null":typeof t});if(Array.isArray(e))this.overlay.post(se.MAGIC_HANDLE_REQUEST,e.map(r=>{let i=oe(r);return this.prefixPayloadMethodForTestMode(i),i})).then(r=>{t(null,r.map(i=>Ue(me({},i.payload),{error:i.hasError?new ne(i.payload.error):null})))});else{let r=oe(e);this.prefixPayloadMethodForTestMode(r),this.overlay.post(se.MAGIC_HANDLE_REQUEST,r).then(i=>{t(i.hasError?new ne(i.payload.error):null,i.payload)})}}send(e,t){if(typeof e=="string"){let i=m(e,Array.isArray(t)?t:[]);return this.request(i)}if(Array.isArray(e)||t){this.sendAsync(e,t);return}let r=pr();return r.log(),new fe(e).applyError({code:-32603,message:r.rawMessage}).payload}enable(){let e=m("eth_accounts");return this.request(e)}request(e){return this.prefixPayloadMethodForTestMode(e),super.request(e)}prefixPayloadMethodForTestMode(e){let t="testMode/eth/";this.sdk.testMode&&(e.method=`${t}${e.method}`)}};function be(e,t){return t?new URL(e,t):new URL(e)}var Pe=["request","overlay","sdk"];function Wr(e){let t=Object.getPrototypeOf(e),r=[t];for(;t!==U.prototype;)t=Object.getPrototypeOf(t),r.push(t);return r}var Qe=class extends U{constructor(){super(void 0),this.__sdk_access_field_descriptors__=new Map,this.__is_initialized__=!1,this.utils={createPromiEvent:Xe,isPromiEvent:vr,encodeJSON:xe,decodeJSON:ir,createJsonRpcRequestPayload:m,standardizeJsonRpcRequestPayload:oe,storage:Ke};let e=[this,...Wr(this)];Pe.forEach(t=>{let r=e.map(u=>Object.getOwnPropertyDescriptor(u,t)),i=r.findIndex(u=>!!u),s=i>0,n=r[i];n&&(this.__sdk_access_field_descriptors__.set(t,{descriptor:n,isPrototypeField:s}),Object.defineProperty(this,t,{configurable:!0,get:()=>{throw hr(t)}}))})}init(e){this.__is_initialized__||(Pe.forEach(t=>{if(this.__sdk_access_field_descriptors__.has(t)){let{descriptor:r,isPrototypeField:i}=this.__sdk_access_field_descriptors__.get(t);i?delete this[t]:Object.defineProperty(this,t,r)}}),this.sdk=e,this.__is_initialized__=!0)}createDeprecationWarning(e){let{method:t,removalVersion:r,useInstead:i}=e,s=i?` Use \`${i}\` instead.`:"",n=`\`${t}\` will be removed from this Extension in version \`${r}\`.${s}`;return new Le(this,"DEPRECATION_NOTICE",n)}createWarning(e,t){return new Le(this,e,t)}createError(e,t,r){return new We(this,e,t,r)}},jr=class extends Qe{},X=class extends Qe{};X.Internal=jr,X.Anonymous="anonymous extension";var Fr=class extends U{purchase(e){let t=m(d.NFTPurchase,[e]);return this.request(t)}checkout(e){let t=m(d.NFTCheckout,[e]);return this.request(t)}};function Ce(e){return e.compat&&e.compat[f.sdkName]!=null?typeof e.compat[f.sdkName]=="string"?Kt(Qt(f.version),e.compat[f.sdkName]):!!e.compat[f.sdkName]:!0}function qr(e){var t;let r=(t=e==null?void 0:e.extensions)!=null?t:[],i={},s=[];if(Array.isArray(r)?r.forEach(n=>{Ce(n)?(n.init(this),(n.name||n.name!==X.Anonymous)&&(this[n.name]=n),n instanceof X.Internal&&(de(n.config)||(i[n.name]=n.config))):s.push(n)}):Object.keys(r).forEach(n=>{if(Ce(r[n])){r[n].init(this);let u=r[n];this[n]=u,u instanceof X.Internal&&(de(u.config)||(i[r[n].name]=u.config))}else s.push(r[n])}),s.length)throw cr(s);return i}var ie=class{constructor(e,t){this.apiKey=e;var r;if(!e)throw lr();f.platform==="react-native"&&(t!=null&&t.endpoint)&&mr().log();let{defaultEndpoint:i,version:s}=f;this.testMode=!!(t!=null&&t.testMode),this.endpoint=be((r=t==null?void 0:t.endpoint)!=null?r:i).origin,this.auth=new yr(this),this.user=new Dr(this),this.wallet=new xr(this),this.nft=new Fr(this),this.rpcProvider=new Gr(this);let n=qr.call(this,t);this.parameters=xe(me({API_KEY:this.apiKey,DOMAIN_ORIGIN:window.location?window.location.origin:"",ETH_NETWORK:t==null?void 0:t.network,host:be(this.endpoint).host,sdk:ar[f.sdkName],version:s,ext:de(n)?void 0:n,locale:(t==null?void 0:t.locale)||"en_US"},f.bundleId?{bundleId:f.bundleId}:{}))}get overlay(){if(!ie.__overlays__.has(this.parameters)){let e=new f.ViewController(this.endpoint,this.parameters);e.init(),ie.__overlays__.set(this.parameters,e)}return ie.__overlays__.get(this.parameters)}preload(){return A(this,null,function*(){yield this.overlay.ready})}},Vr=ie;Vr.__overlays__=new Map;function Hr(e,t){return t&&Array.isArray(e)?e.find(r=>r.id===t):e}function Xr(e,t){var r;let i=(r=t.data.response)==null?void 0:r.id,s=Hr(e,i);if(i&&s){let n=new fe(s).applyResult(t.data.response.result).applyError(t.data.response.error);return{id:i,response:n}}return{}}function Br(e,t){return A(this,null,function*(){let r=yield S("rt"),i;if(f.platform==="web")try{i=yield Lr()}catch(s){console.error("webcrypto error",s)}return i?r?{msgType:e,payload:t,jwt:i,rt:r}:{msgType:e,payload:t,jwt:i}:{msgType:e,payload:t}})}function Kr(e){return A(this,null,function*(){!e.data.rt||(yield W("rt",e.data.rt))})}var Qr=class{constructor(e,t){this.endpoint=e,this.parameters=t,this.messageHandlers=new Set,this.ready=this.waitForReady(),this.listen()}post(e,t){return A(this,null,function*(){return Be(r=>A(this,null,function*(){yield this.ready;let i=[],s=Array.isArray(t)?t.map(h=>h.id):[],n=yield Br(`${e}-${this.parameters}`,t);yield this._post(n);let u=h=>l=>{let{id:a,response:c}=Xr(t,l);Kr(l),a&&c&&Array.isArray(t)&&s.includes(a)?(i.push(c),i.length===t.length&&(h(),r(i))):a&&c&&!Array.isArray(t)&&a===t.id&&(h(),r(c))},o=this.on(x.MAGIC_HANDLE_RESPONSE,u(()=>o()))}))})}on(e,t){let r=t.bind(window),i=s=>{s.data.msgType===`${e}-${this.parameters}`&&r(s)};return this.messageHandlers.add(i),()=>this.messageHandlers.delete(i)}waitForReady(){return new Promise(e=>{this.on(x.MAGIC_OVERLAY_READY,()=>e())})}listen(){this.on(x.MAGIC_HIDE_OVERLAY,()=>{this.hideOverlay()}),this.on(x.MAGIC_SHOW_OVERLAY,()=>{this.showOverlay()})}};export{k as $,tt as I,ue as K,ne as L,rt as T,Le as Z,be as _,X as a,Vr as b,vr as c,et as d,re as e,zr as f,Jr as g,x as h,C as i,We as j,se as l,pe as m,Y as o,O as p,Qr as q,d as u,Yr as w};
