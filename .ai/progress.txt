# AI Workflow Progress Log

This file tracks AI-assisted development work on Commonwealth.
Each AI run should append an entry with:
- Date and feature description
- GitHub issue reference
- Key implementation decisions
- Files changed
- Tests added/updated
- Concerns for reviewers
- Commit hash

---

[2026-01-06] Initial Setup: GitHub-First AI Workflow with Automatic Branching
- Migrated from prd.json to GitHub Issues as single source of truth
- Created .ai/run.sh with automatic branch creation and management
- Implemented branch naming convention: <author>/<type>-<issue-number>-<title-slug>
- Author determination: AI_AUTHOR_INITIALS env var > git config user.initials > derived from git user.name
- Created .ai/setup-labels.sh for label setup (includes type:* labels)
- Created .github/ISSUE_TEMPLATE/ai-task.md template with type labels
- Created .ai/create-ticket.sh - AI-powered ticket generator from descriptions
- Created .ai/quickstart.md - Quick start guide for new developers
- Updated readme with comprehensive workflow guide and branching strategy
- Branch creation logic: detects author, type from labels, generates slug from title
- Handles edge cases: existing branches, non-master starting point, manual branches
- Ticket generator: analyzes description, infers metadata, generates compliant issues
- Example branches: ro/feature-1234-add-user-auth, ro/fix-5678-button-alignment
- Commit: (to be added by next commit)

---

[2026-01-07] Feature Flag: FLAG_MARKETS for Prediction Markets Visibility Control
- Completed GitHub issue #13265
- Added FLAG_MARKETS feature flag to control visibility of prediction markets functionality across the application
- Key implementation decisions:
  * FLAG_MARKETS already defined in feature-flags.ts using buildFlag helper (line 52)
  * FLAG_MARKETS already exposed in vite.config.ts (line 73)
  * Routes already conditionally rendered in navigation files using spread operator pattern
  * Updated governance_section.tsx to use marketsEnabled flag for Markets menu item visibility
  * Updated AdminSection.tsx to use marketsEnabled flag for Market Integrations menu visibility
  * Added FLAG_MARKETS to .env.example with default value of false for safe rollout
- Files changed:
  * packages/commonwealth/client/scripts/views/components/sidebar/governance_section.tsx - Added useFlag('markets') and set isVisible: marketsEnabled for Markets menu
  * packages/commonwealth/client/scripts/views/components/sidebar/AdminSection/AdminSection.tsx - Added useFlag('markets') import and set isVisible: marketsEnabled for Market Integrations menu
  * .env.example - Added FLAG_MARKETS documentation in Feature Flags section
- Tests:
  * Type checking shows pre-existing Soneium-related errors (not introduced by this change)
  * Linting shows pre-existing warnings in market integration files (not introduced by this change)
  * Unit tests require database connection (not available in current environment)
  * Manual verification required: test with FLAG_MARKETS=true and FLAG_MARKETS=false
- Concerns for reviewers:
  * Verify Markets menu in Apps section hides when FLAG_MARKETS=false
  * Verify Market Integrations in Admin Capabilities section hides when FLAG_MARKETS=false
  * Test direct URL access to /markets-app and /:scope/manage/markets when flag is disabled
  * Confirm routes properly return 404 or redirect when flag is off
- Commit: 14779d72899558242378b4e6006a004d7e9ed438
- Follow-up fix for React Hooks error:
  * Converted Router from a function to a React component
  * Router now returns <RouterProvider> directly instead of router config object
  * Moved useFlag('markets') call to Router component where hooks are properly called
  * Updated App.tsx to use <Router /> as component instead of router()
  * Passed marketsEnabled as parameter to CommonDomainRoutes/CustomDomainRoutes
  * Fixed "Rendered more hooks than during the previous render" error
  * Commit: f3910b09be

---
